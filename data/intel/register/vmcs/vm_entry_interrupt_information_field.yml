- name: vm_entry_interrupt_information_field
  long_name: "VM-entry interruption-information field"
  purpose: |
      "
       This field provides details about the event to be injected. Table 24-14
       describes the field.
      "
  size: 32
  arch: intel

  access_mechanisms:
      - name: vmread
        encoding: 0x00004016

      - name: vmwrite
        encoding: 0x00004016

  fieldsets:
      - name: latest
        condition: "Fieldset valid on latest version of the Intel architecture"
        size: 32

        fields:
            - name: "Vector of interrupt or exception"
              long_name: "Vector of interrupt or exception"
              description: |
                  "
                  The vector (bits 7:0) determines which entry in the IDT is
                  used or which other event is injected
                  "
              lsb: 0
              msb: 7
              readable: True
              writable: True

            - name: "Interruption type"
              long_name: "Interruption type"
              description: |
                  "
                  The interruption type (bits 10:8) determines details of how
                  the injection is performed. In general, a VMM should use the
                  type hardware exception for all exceptions other than the
                  following: • breakpoint exceptions (#BP; a VMM should use the
                  type software exception); • overflow exceptions (#OF a VMM
                  should use the use type software exception); and • those
                  debug exceptions (#DB) that are generated by INT1 (a VMM
                  should use the use type privileged software exception).1 The
                  type other event is used for injection of events that are not
                  delivered through the IDT.
                  "
              lsb: 8
              msb: 10
              readable: True
              writable: True

            - name: "Deliver error code"
              long_name: "Deliver error code (0 = do not deliver; 1 = deliver)"
              description: |
                  "
                  For exceptions, the deliver-error-code bit (bit 11)
                  determines whether delivery pushes an error code on the guest
                  stack.
                  "
              lsb: 11
              msb: 11
              readable: True
              writable: True

            - name: "reserved"
              long_name: "Reserved"
              lsb: 12
              msb: 30
              reserved0: True

            - name: "Valid"
              long_name: "Valid"
              description: |
                  "
                  VM entry injects an event if and only if the valid bit (bit
                  31) is 1. The valid bit in this field is cleared on every VM
                  exit (see Section 27.2).
                  "
              lsb: 31
              msb: 31
              readable: True
              writable: True
